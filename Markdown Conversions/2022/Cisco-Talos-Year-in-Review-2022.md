# 2022 YEAR IN REVIEW

## Table of Contents
- [INTRODUCTION](#introduction)
- [MAJOR EVENTS](#major-events)
    - [Ukraine](#ukraine)
    - [Log4j](#log4j)
- [THREAT LANDSCAPE](#threat-landscape)
    - [Review of the general threat landscape in 2022](#review-of-the-general-threat-landscape-in-2022)
    - [Ransomware threat landscape](#ransomware-threat-landscape)
    - [Commodity loaders](#commodity-loaders)
- [ADVANCED PERSISTENT THREAT ACTIVITY](#advanced-persistent-threat-activity)
    - [Advanced persistent threats](#advanced-persistent-threats)
- [Conclusion](#conclusion)

## INTRODUCTION
Welcome to the inaugural Cisco Talos Year in Review.
This report represents an unprecedented effort within Cisco to tell a comprehensive story of our work in the past year, relying on a wide variety of data and expertise.
As a large security organization with global reach, the data we use as the basis for our research presents us with both a gift and a curse. The gift lies in the diversity of inputs, ranging from endpoint detections, incident response engagements, network traffic, email corpus, data from our sandboxes and honeypots, and much, much more from customers all over the world. The curse is that with the multitude of telemetry we have access to and the urgency of some of the work we do, it can be difficult to take a step back and look at the bigger picture, like trying to make sense of a Monet with your nose up against the frame.
This is what inspired us to create the Cisco Talos Year in Review. We wanted to get insight from dozens of subject matter experts all throughout Cisco, including our reverse engineers, detection specialists, data scientists, linguists, managed hunt providers, incident responders, and threat intelligence analysts. To this diverse group, we posed a few key questions:
1. What were the major security events Cisco responded to in 2022 and what is their current status and impact?
2. What are the major trends in the threat landscape and what do we think may change?
3. What are the top threats we observed in 2022 and what is their current state?
This report tells a story based on responses to these questions from our experts and their year-long data. Through the upcoming weeks, we will be highlighting different aspects of this story, including our efforts in Ukraine, the disastrous Log4j vulnerabilities, adversaries’ use of offensive frameworks and software native to the victim’s machine, shifts in the ransomware landscape, the ever-present threat of commodity loaders/trojans, as well as an overview of some of the advanced persistent threats (APTs) we are most concerned with. Throughout the story, one key theme is clear: adversaries are adapting to shifts in the geopolitical landscape, actions from law enforcement, and the efforts of defenders. Defenders will need to track and address these shifts in behavior in order to maintain resilience. We expect this data-driven story will shed some insight into Cisco’s and the security community’s most notable successes and remaining challenges. In addition, as these Year in Review reports continue in the future, we aim to provide data and narratives that help explain how the threat landscape changes from one year to the next. We hope you find this report as elucidating to read as it was to research and write, and that it arms the security community with the information and context needed to continue fighting the good fight.

## MAJOR EVENTS

### Ukraine
Talos’ ongoing support for Ukraine has been a large focus of our operational efforts this year. Driven by our core mission of protecting the Ukrainian people and infrastructure from cyber attacks, our work has also enhanced our knowledge of the Russian adversary and wartime cyber threat landscape—information that will inform and enrich our analysis, defenses, and strategies for addressing similar crises in the future. In this section, we look back on our Ukraine-related work from 2022 and provide some strategic takeaways about the threat landscape and adversary behavior, based on Cisco telemetry, Cisco Talos Incident Response (CTIR) data, and case studies from our ongoing internal Ukraine task unit.

#### TASK UNIT DRIVES TALOS’ UKRAINE SUPPORT, SERVES AS MODEL FOR FUTURE CRISIS RESPONSE
In the weeks and months leading up to Russia’s February invasion of Ukraine, Cisco Talos quickly spun up a vast effort to support our Ukrainian friends and partners. This effort was unprecedented in scope and pace, as we rapidly expanded our Ukraine coverage, deployed and managed Cisco security products on new Ukrainian endpoints, and refocused parts of our workforce to surge their monitoring and detection capabilities in support of this effort. Much of this work continues today as part of an ongoing, comprehensive wartime effort to protect the people of Ukraine and enhance the resilience of Ukrainian organizations.
As part of this work, we developed an internal Ukraine task unit that has become a prototype for how we can respond to future global events that are likely to have significant, ongoing cyber implications (Figure 1).
![Figure 1. Current Cisco support for Ukrainitan critical infrastrucuture and government partners since the beginning of the Russia-Ukraine war.]
The task unit is comprised of about 45 volunteers from across the Talos organization, including threat hunters, malware reverse engineers, incident responders, data scientists, and others. These experts monitor around 30 Ukraine-based Cisco customers from various critical infrastructure sectors, providing critical support while also gathering information that has been instrumental to enhancing our knowledge of the adversary and wartime cyber threat space. Our observations from the task force helped inform this section of the report.

#### UKRAINE THREAT LANDSCAPE SEES DIVERSE SET OF ACTORS, THREATS
Since the start of the war in February, we have observed an unprecedented number of adversaries—driven by different motivations and of varying skill levels—clustered in the same threat landscape. This level of activity is in some ways familiar for Ukraine and its allies, as the country has been defending itself from a variety of sophisticated cyber attacks since at least 2014 (Figure 2). The variety of actors involved in this most recent conflict has presented a diverse set of challenges for customers, partners, and defenders who have had to respond to ongoing changes in adversary tactics, techniques, and procedures (TTPs), new and evolving threats, and difficulties attributing activity to specific groups. This diverse set of actors has remained active throughout the year.
![Figure 2. Major cyber attacks against Ukraine.]
Cybercriminals, wiper malware, and APTs were quick to enter the threat landscape
Cybercriminals, known for being highly opportunistic, are a mainstay in this threat space. Since the beginning of the war, we have observed threat actors sending email lures with themes related to the conflict, including humanitarian assistance and various types of fundraising (Figure 3). These emails are primarily used for scam activity but have also delivered a variety of threats, including remote access trojans (RATs). This pattern is consistent with what we typically see following global events or crises, such as the COVID-19 pandemic, when opportunistic cybercriminals attempt to exploit high public interest for their own gain, underscoring their adaptability.
We also observed cybercriminals attempting to exploit Ukrainian sympathizers by offering offensive cyber tools to target Russian entities that were in fact malware. In one such instance, we observed an actor named “disBalancer” offering a purported distributed denial-of-service (DDoS) tool, “Liberator,” on Telegram to attack Russian propaganda websites (Figure 4). The downloaded file is actually an information stealer that infects the unwitting victim with malware designed to dump credentials and harvest cryptocurrency-related information.
State-sponsored threat actors and other sophisticated adversaries have also been highly active throughout the war. The Russian state-sponsored advanced persistent threat (APT) Gamaredon, for example, has been a major player. The group has historically targeted predominantly Ukrainian entities—particularly those responsible for the country’s defense, diplomacy, and internal security—and those activities have only increased since Russia’s invasion in February. In September, we identified a new Gamaredon campaign infecting Ukrainian users with custom information-stealing malware that can exfiltrate victim files of interest and deploy additional payloads. We also discovered likely Russian state-sponsored actors deploying a modified version of the GoMet open-source backdoor against a Ukrainian software company. This was possibly an attempted supply chain attack, as the target’s software is widely used by Ukrainian government entities and the malware was designed to establish persistent access.
![Figure 3. Malspam message themed as humanitarian aid request for Ukrainian refugees.]
![Figure 4. Screenshot showing disBalancer’s “Liberator” advertisement.]
We also saw other sophisticated actors leverage the war to their advantage, often by creating themed lures to deliver malware to victims. Corresponding with Russia’s invasion in February, the China-based threat actor Mustang Panda began conducting phishing campaigns against European entities, including Russian organizations. Some phishing messages contained malicious lures masquerading as official European Union (EU) reports on the war and its effects on North Atlantic Treaty Organization (NATO) countries. Other phishing emails delivered fake "official" Ukrainian government reports, both of which download malware onto compromised machines.
We have discovered or analyzed countless other threats that, while unattributed to specific actors, highlight the variety of adversaries and malware that persist in this threat landscape. Leading up to and immediately following Russia’s invasion of Ukraine, threat actors began deploying a variety of destructive wipers and other malware against Ukrainian targets, including WhisperGate, HermeticWiper, CaddyWiper, DoubleZero, and CyclopsBlink. Some of these threats were likely deployed by state-sponsored adversaries, based on our analysis and U.S. government reports. More recently, Talos’ internal Ukraine task unit has identified a wide variety of threats affecting our Ukrainian partners. These range from common threats like the IcedID commodity loader and Sality malware to more sophisticated, targeted threats like WannaCry ransomware, Industroyer2 destructive malware, GrimPlant backdoor, and GraphSteel information-stealer.

#### Russia-aligned actors target NATO countries
As the war wages on, we are seeing new groups emerge motivated by clear political objectives, highlighting the dynamic threat space and continued impact of geopolitical events on the cyber landscape. One such adversary is Killnet, a hacktivist group that conducts distributed denial-of-service (DDoS) attacks in support of pro-Russian interests. The group has been active since February 2022—coinciding with the start of the war—and has garnered media attention for a spate of attacks against Western nations, including several U.S. states and major U.S airports.
The group launched its first DDoS attacks against two dozen Ukrainian government websites in response to the Anonymous hacktivist group targeting Russian entities. Over the next several months, Killnet quickly began targeting websites of pro-Ukraine countries, including Poland, Norway, Lithuania, Italy, Romania, Estonia, and Japan. Killnet attacked Lithuania, for example, in response to the country blocking the transit of goods to Russia. The DDoS attacks have been targeted at various government websites that typically affect multiple services and operations, such as Ministries of Defense, transportation, banking, and police.
While Killnet’s operations have so far been limited to disruptive attacks, there are some indications that the group may look to expand its attack arsenal going forward. Earlier this year, Killnet reportedly sought to recruit ransomware gangs to attack entities on their behalf, suggesting that they may develop their own variant or purchase one from an underground market to conduct more destructive attacks. Additionally, Killnet reportedly leveraged the Mirai botnet to scale their attack capabilities earlier this year, further highlighting the group’s interest in expanding their malware arsenal.
Killnet’s offensive operations are unsophisticated and do not leverage custom tools or malware. Victims are often able to recover quickly from the DDoS attacks, suggesting that Killnet is more intent on garnering media attention for their cause rather than inflicting maximum damage or disruption against their targets. Killnet’s decentralized structure, fervent Russian nationalism, and high-profile victims suggest that countries or organizations perceived to be pro-Ukraine or anti-Russia are viable targets in the months ahead.

#### TELEMETRY REVEALS TOP THREATS, ACTIVITY TRENDS SINCE BEGINNING OF WAR
Based on a review of our endpoint telemetry between January and September, we gained unique insights into historic threat trends since the start of the conflict. These findings are based on Behavioral Protections (BP) data, which is an engine in Cisco Secure Endpoint that detects and blocks malicious activity based on rules that we write. Based on this data, we derived a list of the top 10 most active BP signatures across Ukrainian entities customers and partners (Figure 5).
![Figure 5. Most active Behavioral Protections rules from Cisco Secure Endpoint across Ukrainian customers where Cisco Secure Endpoint has been deployed.]
Given that this data displays total counts rather than unique endpoints, one or several endpoints could have been firing on the same BP for days or weeks at a time. Still, the graph sheds light on some of the utilities (PowerShell, WMI), techniques (use of Windows Policies Keys to establish persistence and fake Google Chrome executables), and malware (information stealers and cryptocurrency miners) that were prevalent so far during the war. The top offender, “Potential WebShell Creation,” could allow an attacker to control a victim machine via a webUI. That would rely on the victim machine being accessible over HTTP(s) ports, which implies the affected endpoint is a server and not an individual user’s desktop or laptop. The top two most active BPs, “Potential WebShell Creation” and “PowerShell Invoke Expression,” also alerted on the first and second highest number of total days, respectively, meaning that their prevalence is further indicated by the frequency with which we observed them over time.
Upon reviewing results from our Exploit Prevention data, which is another Cisco Secure Endpoint detection engine similar to BPs, we see that the number of detections for the “Signed binary proxy execution using rundll32” signature steadily increased beginning in May (Figure 6).
This activity is an exact match to the MITRE ATT&CK technique “System Binary Proxy Execution: Rundll32” (T1218.011). Adversaries use this technique for defense evasion by abusing “rundll32.exe” to proxy execution of malicious code. This helps them avoid triggering security tools that may not monitor execution of the “rundll32.exe” process because of allowlists or false positives from normal administrative operations. Rundll32 is also commonly associated with executing DLL payloads. Interestingly, this technique is also becoming increasingly common during attacks across all customers globally, based on our telemetry (Figure 7). According to MITRE, a variety of threat actors are known to use this technique, including Russia-linked groups Gamaredon, APT28, and APT29.
![Figure 6. rundll32 detections across Ukraine customers.]
![Figure 7. rundll32 detections across all Cisco customers.]
Looking at this data more broadly, we also see that there was a gradual uptick in BP detections across Ukrainian organizations since the start of the war (Figure 8). Activity between March and May stayed consistent, then dramatically increased in June, where it has remained consistently high.
#### Custom, native detection system yields new attacker IPs
When the war started and we began surging efforts to protect the Ukrainian people, we developed several new custom detection systems to help us better identify suspicious activity and potentially targeted attacks. One of those systems allows us to detect unique IP addresses that are targeting Ukrainian entities. IPs are flagged when they exceed a certain targeting threshold, as set by our data scientists. This list is then manually confirmed as malicious and the remaining IOCs are subsequently blocked.
Figure 9 shows a list of attacker IP addresses we have identified based on this detection system that have not been previously reported. All IPs have been blocked in Cisco security products.
![Figure 8. Total number of Behavioral Protection alerts across Ukrainian customers showing increases in activity in March and June.]
![Figure 9. Attacker IPs targeting Ukrainian entities based on custom detections]
```
39.175.68[.]100
192.241.221[.]160
207.249.96[.]145
128.14.225[.]243
128.1.42[.]231
117.208.234[.]11
45.83.192[.]134
152.32.200[.]79
103.178.237[.]134
143.244.135[.]246
85.198.141[.]6
61.52.46[.]172
31.43.190[.]200
167.172.69[.]26
206.189.37[.]136
152.32.153[.]235
185.218.200[.]1
178.128.103[.]166
```

#### INITIAL DROP IN TALOS IR OBSERVED THREATS SUGGESTS THREAT ACTORS FOCUSED ON RUSSIAN, UKRAINIAN TARGETS
In addition to our telemetry indicating that threat activity directed at Ukrainian entities has remained high over the last several months, our Cisco Talos Incident Response (CTIR) data also suggests that threat actors have been focused on the Russia-Ukraine attack space since the start of the war. Our incident responders observed fewer threats affecting Cisco customers in the first half of 2022. Threats like ransomware, information stealers, commodity malware, and exploitation of known vulnerabilities were notably lower between February and June, corresponding to the early months of the war. The volume of CTIR-observed threats returned to near-normal numbers around July.
While it’s impossible to determine a direct cause for this drop, we assess that the Russia-Ukraine war likely played a key role. Many threat actors who would have traditionally been targeting entities across various geographic regions and sectors likely shifted their attention to pro-Russia or pro-Ukraine cyber efforts. This assessment is supported by the variety of threat actors and heightened activity we are seeing in the region, as detailed earlier in this report. Russia’s invasion and harsh war tactics have drawn strong reactions from both pro-Russian and pro-Ukrainian supporters. This was reflected in the cyber landscape early on in the conflict, when we saw an influx of actors enter the Russia-Ukraine theater in support of both sides. This surge of interested actors reveals how the complex geopolitical environment can influence threat actor behavior.
In addition to shifting adversaries' attention away from traditional targets, the war has also caused conflict and infighting within different threat groups that may also have contributed to the early decline. Following Conti’s public declaration of support for Russia, a disgruntled affiliate leaked the ransomware group’s playbook that contained valuable operational information. A wave of distributed denial-of-service (DDoS) attacks in August and September caused operational and security challenges for several ransomware groups, discussed in more detail later in the report, likely further diverting their attention away from traditional operations.

#### CONCLUSION
We assess that the threat to Ukrainian and allied government and private sector entities will remain high throughout the duration of the war. Our telemetry, task unit findings, and threat hunting discoveries show no indication that the threat activity level against Ukrainian organizations is slowing down. While the variety of threats facing these entities will likely continue to vary, we assess that more destructive attacks are particularly more likely to occur given Russian adversaries’ past preference for—and success in—deploying wiper malware against Ukrainian entities since 2014. As Russia doubles down on its objectives to occupy and annex portions of Ukraine, and as Moscow shows a consistent willingness to carry out dramatic, high-impact kinetic attacks against civilian and critical infrastructure entities, we judge that Russian cyber threat actors will similarly conduct aggressive and brazen attacks as necessary to affect the outcome of the war. Furthermore, we assess that the potential for increased cyber threat activity will likely continue past any future kinetic ceasefires on the battlefield.

### Log4j
In December 2021, the notorious vulnerabilities affecting the common Log4j library in Apache software were disclosed, kicking off an ongoing, months-long effort by Talos to mitigate associated threats. Due to organizations’ widespread use of Log4j, the massive attack surface creates a multitude of potential entry points for adversaries to gain access to vulnerable systems. Moreover, Log4j libraries are often embedded within other systems, making it difficult for organizations to determine whether the vulnerabilities exist in their infrastructure and, if so, where and to what extent. Actors of all skill levels, including sophisticated APTs, continue to exploit vulnerable Log4j systems. The unique challenges posed by this set of vulnerabilities (CVE-2021-44228, CVE-2021-45046, and CVE-2021-45105) indicate they will remain long-lasting challenges for organizations and cybersecurity providers. In this section, we provide an update on 2022 Log4j-related activity trends based on Talos telemetry to highlight one of the most impactful threats from this year and to remind organizations that active exploitation against older vulnerabilities remains a pervasive issue.
![Figure 10. Top infection vectors based on Talos IR data.]

#### LOG4J EXPLOITATION ATTEMPTS REMAIN CONSISTENTLY HIGH
Nearly a year after the Log4j vulnerabilities were discovered, threat actors continue to exploit the security flaws at a high rate, according to several Talos data sets. In mid-January, less than a month after the security flaws had been disclosed, we immediately saw mass exploitation attempts against VMware Horizon servers running vulnerable Log4j versions. Targeted organizations spanned across multiple sectors, highlighting the indiscriminate nature of the targeting attempts. We first began seeing this activity in our Cisco Secure Endpoint data and honeypot telemetry, and soon identified multiple clusters of post-exploitation behavior, including the deployment of various cryptocurrency miners and additional malware, the use of PowerShell reverse shells, and VMware commands issued for system information discovery.
The volume of associated threat activity quickly expanded, as did the variety of adversaries attempting to scan for and exploit vulnerable systems (Figure 10). In the first quarter of 2022, Log4j exploitation attempts ranked number two among the most common threats affecting Cisco customers, according to Cisco Talos Incident Response (CTIR) data. This was second to ransomware, a constant mainstay as a top threat. Through the first half of 2022, exploitation of public-facing applications was tied with phishing as the top initial infection vector, according to CTIR findings, highlighting the presence of Log4j in incident response engagements. In Q3, nearly 15 percent of engagements saw adversaries identify and/or exploit misconfigured public-facing applications, including conducting Structured Query Language (SQL) injection attacks against external websites, exploitation of Log4Shell in vulnerable versions of VMware Horizon, and targeting of misconfigured and/or publicly exposed servers.
In addition to CTIR data, our Snort telemetry—which identifies malicious network traffic via signatures—helps paint a clear picture of the consistently high volume of Log4j threat activity throughout the year. Based on a review of our 44 Snort IDs (SIDs) that detect exploitation attempts against Log4j vulnerabilities, we found that the volume of alerts on these SIDs ballooned nearly 40 percent in January. Although it has since leveled off from April onwards, the number of alerts still remains in the tens of millions. (Figure 11).
Beyond highlighting threat actors’ continued interest in scanning for vulnerable Log4j systems, the data is also largely representative of the volume of attacks Snort helped prevent. Any time a SID detects malicious activity, it drops the network traffic unless the user or organization changed the rule’s preset configuration.. All of the SIDs from this data set are rules that look for attempts to exploit a remote code execution vulnerability in Log4j’s “lookup” functionality, the Java Naming and Directory Interface (JNDI). This relates directly to the “Log4Shell” vulnerability (CVE-2021-44228). The top five SIDs accounting for the highest numbers of detections were 58722, 58723, 58742, 58737, and 58726. These SIDs accounted for 95 percent of the total hits—several million to tens of million per month.
![Figure 11. Total alerts on malicious network traffic identified as Log4j exploitation attempts.]

#### ACTORS OF VARYING SKILL, MOTIVATION LEVERAGE LOG4J IN THEIR OPERATIONS
The surge in Log4j activity was attributed to a variety of different actors throughout 2022, from basic cybercriminals to sophisticated APTs. In one instance during a CTIR engagement, we observed Deep Panda, a suspected Chinese state-sponsored actor, exploiting Log4j to drop a custom backdoor on the victim’s system. The North Korean state-sponsored Lazarus Group is also targeting Log4j in its operations, as we detailed in another blog. These findings are consistent with other reporting on many other advanced threat actors attempting to exploit Log4j vulnerabilities, including Iran’s Islamic Revolutionary Guard Corps (IRGC) and the China-linked APT41.
Cryptocurrency mining groups were among the first to start scanning for and exploiting Log4j—as they often are with new vulnerabilities—including unaffiliated actors and longstanding, well-known gangs like the 8220 Mining Group. Ransomware actors—already broadly known for being highly opportunistic—were also quick to attempt to monetize the Log4j flaws, and continue to do so today. We saw evidence of this in Q2 of this year, when CTIR observed a Conti ransomware affiliate exploiting Log4j on vulnerable VMware Horizon servers. This was consistent with earlier reporting that the adversary had been leveraging Log4j in their operations since December 2021—immediately after the vulnerabilities were made public—highlighting the speed at which actors begin exploiting newly disclosed security flaws as well as the long tail in adversary exploit attempts following initial surges after disclosure.

#### CONCLUSION
We assess that the threat of Log4j exploitation attempts will remain a challenge for organizations well into 2023 and beyond. Cyber threat actors are known to reuse the same tactics, tools, and techniques (TTPs) as long as they remain effective, and Log4j will likely be no exception. Log4j is still a highly viable infection vector for actors to exploit, and we expect that adversaries will attempt to continue to abuse vulnerable systems as long as possible. Although threat actors remain adaptable, there is little reason for them to spend more resources developing new methods if they can still successfully exploit known vulnerabilities.
This logic is supported by CISA’s annual findings on top exploited vulnerabilities. In its 2022 report, CISA found that cyber actors continued to exploit publicly known, dated software vulnerabilities, some of which were also routinely exploited in 2020 or earlier. The exploitation of older vulnerabilities demonstrates the continued risk to organizations that fail to patch software in a timely manner or are using software that is no longer supported by a vendor.
Log4j’s pervasiveness in organizations’ environments makes patching challenging. Since the library is so widely used, Log4j may be deeply embedded within large systems, making it difficult to inventory where all software vulnerabilities may be in a particular environment. Moreover, there is no uniform patching system for Log4j, meaning it does not push software updates—including important security upgrades—regularly or automatically. As highlighted earlier, the number of CTIR engagements that exploited Log4j in 2022 underscores adversaries’ reliance on targeting unpatched and vulnerable public-facing applications. Actors’ successful targeting, organizations’ challenges around patching, Log4j’s pervasiveness, and adversaries’ historic propensity to exploit known vulnerabilities suggests that Log4j will remain a threat well into 2023.

## THREAT LANDSCAPE

### Review of the general threat landscape in 2022
While our ongoing support to Ukraine and response to the Log4j vulnerabilities were two of our most comprehensive and impactful efforts in 2022, we also dealt with a multitude of other threats as the security community faced an expanding set of adversaries and malware. In January, we identified several emerging trends that we expected would affect or dominate the threat landscape in 2022, many of which ultimately played out as significant events this year. In this section, we provide an overview of the general threat landscape throughout 2022 and major trends based on telemetry sets gathered across Talos, including behavioral indicators from Secure Malware Analytics, Snort and ClamAV alerts, Behavioral Protections (BPs) from Cisco Secure Endpoint, and case studies from CTIR engagements.

#### DUAL-USE TOOLS PROVIDE ACTORS A STEALTHY MEANS OF STAYING UNDETECTED IN AN ENVIRONMENT
Threat actors, including APTs, ransomware operators, and cybercrime groups, leverage offensive frameworks to support a range of actions across an attack lifecycle. These frameworks are referred to as dual-use tools because they are legitimately used by offensive security teams. These tools also provide an additional layer of protection through anonymity: cybersecurity professionals often have difficulty attributing use of these tools to any particular group since they can be observed across many different actors, and the TTPs observed in operations leveraging dual-use tools can vary greatly.
Cobalt Strike continues to remain a popular option for cyber threat actors. This legitimate network defense tool and threat emulation software has a range of capabilities, including reconnaissance, post-exploitation activity, and a range of attack simulations, making it a highly functional tool for adversaries. In early June, we observed an uptick in Snort ID (SID) 53658 for Cobalt Strike download attempts and Secure Malware Analytics behavioral indicator detections for Cobalt Strike-named pipe usage, as seen in Figures 12 and 13, respectively This coincided with a 10 percent increase in Cobalt Strike sightings in CTIR engagements since January.
![Figure 12. Detections for a Cobalt Strike Snort SID 53658.]
![Figure 13. Behavioral indicators alerting on Cobalt Strike-named pipe usage.]
In August, Talos discovered a campaign delivering Cobalt Strike beacons that could be used in future follow-on attacks. The discovered payload was a leaked version of a Cobalt Strike beacon containing commands to perform targeted process injection of arbitrary binaries. Cobalt Strike source code was leaked in late 2020, and the number of cracked and modified versions seen in the wild speaks to the tool’s success in operations. It also highlights malware operators’ willingness to continue to incorporate leaked versions of popular frameworks into their own operations.
Talos and the security community have been dealing with Cobalt Strike for years, continuously developing better and more robust detections. We assess that threat actors may have adapted their behavior to these developments by turning to additional offensive frameworks such as Sliver and Brute Ratel.
Earlier this year, we began observing activity in our endpoint telemetry for the Sliver open-source red-teaming framework. This activity coincided with a CTIR engagement in March where Sliver was used to support a Conti ransomware attack exploiting Log4j for initial access. The following is a case study from a CTIR engagement of a Conti affiliate incorporating Sliver which shows the adversary leveraging legitimate remote management tools as well:
> The attackers gained initial access by exploiting Log4j on an unpatched, vulnerable VMware Horizon server. CTIR observed subsequent PowerShell commands attempting to download and silently execute a malicious Windows Installer file (“setup.msi”). This initiated the installation of Atera Agent, a legitimate remote management tool that provides a connection option for the ransomware affiliate to achieve persistence using a number of remote access tools, such as AnyDesk and Splashtop. PowerShell was used to install AnyDesk: “C:\Program Files (x86)\AnyDeskMSI\AnyDeskMSI.exe --service”. The adversary then used PowerShell commands to attempt to download and execute a payload masquerading as a VMware executable, identified as the Sliver implant. When executed, the sample connected to a C2 and appeared to sit dormant until additional commands were received.
At that time, Sliver’s presence in an IR engagement was notable as there were no publicly reported instances of Conti previously leveraging the implant in their operations. Sliver has since been publicly reported as a Cobalt Strike alternative and has been adopted into a variety of actors’ toolkits. In June, Talos identified Avos ransomware affiliate(s) gaining a foothold via VMware Horizon Unified Access Gateways vulnerable to Log4j and using Cobalt Strike and Sliver in post-exploitation activities.
Besides Sliver, adversaries have also been increasingly turning to the adversarial attack simulation tool Brute Ratel (BRc4). Actively being used to support attacks in the wild, Brute Ratel is of particular concern since the toolkit was cracked in late September and is being shared for free across several hacking forums and communities. This coincided with what Talos believes are the first reported instances of Qakbot operators using Brute Ratel. In June and September, two clusters of activity in our endpoint telemetry revealed an attack chain with Qakbot eventually dropping Brute Ratel. We assess that Brute Ratel's rise in the threat landscape along with Qakbot operators’ recent adoption and the availability of the cracked version, will likely lead to more threat actors adopting the post-exploitation kit into their operations.
Talos discovered two new offensive frameworks called "Manjusaka" and “Alchimist.” Although implemented in different ways, both follow the same design philosophy and virtually the same set of features, seemingly having the same list of requirements despite being created by different developers. They are designed and implemented to operate as standalone GoLang-based executables that can be distributed with relative ease, providing even amateur adversaries the capabilities to carry out operations. Alchimist is already being used in the wild, and although we haven't observed widespread usage of Manjusaka as of this writing, it has the potential to be adopted by threat actors globally.
*   **Cobalt Strike**
    *   A legitimate network defense tool and threat emulation software that has a range of capabilities, including reconnaissance, post-exploitation activity, and a range of attack packages, making it a highly functional tool for adversaries.
    *   Beacon is Cobalt Strike's payload for generating attacks and creating outbound traffic over HTTP, HTTPS, or DNS. Cobalt Strike beacons can be compared with Meterpreter, which is part of the Metasploit framework, and used by penetration testers and offensive security researchers when delivering their services.
*   **Brute Ratel**
    *   A legitimate sophisticated red-teaming tool released in 2020 as an attack simulation tool. It has since been leveraged by threat actors to facilitate various stages of the attack lifecycle.
    *   Brute Ratel is specifically designed to avoid detection by endpoint detection and response (EDR) and antivirus (AV).
*   **Sliver**
    *   An open-source red-teaming framework and attack simulation tool that can be used to perform security testing. Sliver's implants are dynamically cimpiled with asymetric encryption keys per binary and supports C2 over a number of protocols (mTLS, HTTP, DNS).
    *   Sliver implants are supported on MacOS, Windows, and Linux . Sliver features multiple functionalies including staged and stageless payloads, dynamic code generation, named pipe pivots, in-memory .NET assembly execution, and much more.
Talos has observed additional dual-use tools as well. From July to September, CTIR saw a notable use of publicly available tools and scripts hosted on GitHub repositories or third-party websites to support operations across multiple stages of the attack lifecycle. From CTIR engagements in Q3 alone, over 50 percent of the tooling focused on accessing and collecting credentials, highlighting the role these tools play in potentially furthering an adversary’s objectives during that stage of an attack (Figure 14). CTIR commonly observes offensive security and red-team tools to support an adversary’s objectives; however, their increased presence indicates that adversaries are continuing to identify more flexible options to stay under the radar and achieve their objectives, highlighting their adaptability.
It is important to keep track of dual use tools so that enterprises can effectively monitor them in their environments. As the cybersecurity community continues to enhance detections, adversaries will likely continue to adapt and experiment with newer dual-use tools in their attacks.
![Figure 14. Range of tools observed across CTIR engagements in Q3 (July-September 2022).]

#### CONSISTENT USAGE OF LOLBINS
As we look at threats consistently affecting enterprise environments throughout 2022, the usage of living-off-the-land binaries (LoLBins) and the techniques associated with them continue to be leveraged to support a variety of phases across an attack lifecycle. LoLBins are pre-installed on an operating system and are commonly abused by adversaries, combined with fileless malware and/or legitimate cloud services, to improve their chances of staying undetected within an organization. Due to an organization’s use of these tools as part of legitimate administrative functions, defenders may miss attacks leveraging LolBins when monitoring for aberrant behavior.
Cyber threat actors are known to reuse TTPs as long as they remain effective, with LoLBins being no exception. Since Talos’ publication on hunting for LoLBins in 2019, we continue to see legitimate utilities leveraged by adversaries in all stages of an attack to support their operations. Looking at 2022 behavioral protection (BP) data from Cisco Secure Endpoint, four of the 25 most alerted on BP signatures are PowerShell-related, highlighting threat actors’ consistent reliance on the malicious potential of PowerShell (Figure 15). Malicious use of PowerShell is pervasive, and is leveraged to support a broad range of operations including installing adware like ChromeLoader, downloading cryptocurrency miners, or exploiting vulnerabilities in software such as Elasticsearch.
Microsoft’s PsExec is another native utility that adversaries commonly abuse. With the ability to execute programs or processes remotely, PsExec has played a large role in executing ransomware in 75 percent of ransomware engagements CTIR observed in Q3 (July-September).
In a Black Basta ransomware engagement, CTIR identified another commonly abused LoLBin, "vssadmin.exe," that displays the volume shadow copy backups being used to delete local shadow copies, a common technique associated with ransomware adversaries. Shortly after, PsExec launched the malicious ransomware DLL and deleted local backups with VSSadmin. Files with the extension “.basta” started appearing on the affected endpoints.
